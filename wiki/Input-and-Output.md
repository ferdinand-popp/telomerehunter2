# Input and Output

This page provides a comprehensive overview of input file formats, requirements, and detailed descriptions of all output files generated by TelomereHunter2.

## Input Files

### BAM/CRAM Files

TelomereHunter2 accepts both BAM and CRAM alignment files as input:

- **Tumor BAM/CRAM**: Specified with `-ibt` or `--inputBamTumor`
- **Control BAM/CRAM**: Specified with `-ibc` or `--inputBamControl` (optional)

#### Requirements:
- Files must be indexed (`.bai` or `.crai` files present)
- Reads should be aligned to a reference genome
- For single-cell analysis, reads must contain CB (cell barcode) tags

#### Example usage:
```bash
# Single sample analysis
telomerehunter2 -ibt tumor.bam -o results/ -p SampleID

# Tumor vs control analysis
telomerehunter2 -ibt tumor.bam -ibc control.bam -o results/ -p PairID

# CRAM file analysis
telomerehunter2 -ibt sample.cram -o results/ -p SampleID
```

### Cytoband Files

Cytoband files provide chromosome banding information for visualization and analysis:

- **Format**: Tab-separated values (TSV) without header
- **Columns**: 
  1. Chromosome name (e.g., `chr1`)
  2. Start position
  3. End position  
  4. Band name (e.g., `p36.33`)
  5. Band type (e.g., `gneg`, `gpos25`)

#### Example format:
```
chr1	0	2300000	p36.33	gneg
chr1	2300000	5400000	p36.32	gpos25
chr1	5400000	7200000	p36.31	gneg
```

#### Provided reference files:
- `hg19_cytoBand.txt` - Human genome build GRCh37/hg19
- `hg38_cytoBand.txt` - Human genome build GRCh38/hg38
- `T2T_chm13v2.0_cytoBand.txt` - T2T complete human genome
- `cytoBand_dog.txt` - Dog genome reference

### Custom Telomeric Repeats

You can specify custom telomeric repeat sequences:

#### Default repeats:
- `TTAGGG` (canonical human telomeric repeat)
- `TGAGGG`, `TCAGGG`, `TTCGGG`, `TTGGGG` (telomeric variant repeats - TVRs)

#### Custom usage:
```bash
# Custom species with different repeats
telomerehunter2 -ibt sample.bam -o results/ -p SampleID \
  --repeats TTTAGGG TTAAGGG --repeatsContext TTAAGGG
```

### Single-Cell Mode Requirements

For single-cell analysis with `telomerehunter2-sc`:

- BAM files must contain CB (cell barcode) tags
- Minimum reads per barcode threshold can be set with `--min-reads-per-barcode`
- Default minimum: 10,000 reads per barcode

## Output Files

TelomereHunter2 generates multiple output files organized in a structured directory layout.

### Output Directory Structure

```
results/
├── {sample}_TelomerCnt_{pid}/
│   ├── summary.tsv                      # Main summary statistics
│   ├── TVR_top_contexts.tsv            # Top telomeric variant repeat contexts
│   ├── singletons.tsv                   # Singleton TVRs analysis
│   ├── plots/                           # Visualization directory
│   │   ├── {pid}_GC_distribution.pdf
│   │   ├── {pid}_telomere_content.pdf
│   │   ├── {pid}_TVR_analysis.pdf
│   │   └── ...
│   ├── logs/                            # Log files
│   │   ├── filtering.log
│   │   ├── analysis.log
│   │   └── error.log
│   ├── TVR_context/                     # TVR context analysis files
│   ├── telomeric_reads/                 # Filtered telomeric reads
│   └── tmp/                             # Temporary processing files
└── sc_results/                          # Single-cell specific outputs
    ├── sc_summary.tsv                   # Per-cell summary
    └── barcode_counts.tsv               # Read counts per barcode
```

### Main Output Files

#### 1. summary.tsv

The primary results file containing telomere content estimates and statistics for each sample.

**Fields description:**

| Field | Description |
|-------|-------------|
| `PID` | Project/Patient ID specified with `-p` parameter |
| `sample` | Sample name (tumor/control) |
| `total_reads` | Total number of reads in the input BAM file |
| `read_length` | Estimated read lengths (comma-separated for different lengths) |
| `repeat_threshold_set` | Repeat threshold setting (e.g., "6 per 100 bp") |
| `repeat_threshold_used` | Actual threshold value used in analysis |
| `intratelomeric_reads` | Reads classified as intratelomeric (containing telomeric repeats) |
| `junctionspanning_reads` | Reads spanning telomere-chromosome junctions |
| `subtelomeric_reads` | Reads mapping to subtelomeric regions |
| `intrachromosomal_reads` | Reads mapping within chromosomes |
| `tel_read_count` | Total telomeric read count |
| `gc_bins_for_correction` | GC content bins used for normalization (e.g., "48-52") |
| `total_reads_with_tel_gc` | Total reads with telomeric GC content |
| `tel_content` | **GC-corrected telomere content estimate** |
| `TRPM` | Telomeric Reads Per Million mapped reads |
| `TCAGGG_arbitrary_context_norm_by_intratel_reads` | TCAGGG TVR frequency normalized by intratelomeric reads |
| `TGAGGG_arbitrary_context_norm_by_intratel_reads` | TGAGGG TVR frequency normalized by intratelomeric reads |
| `TTGGGG_arbitrary_context_norm_by_intratel_reads` | TTGGGG TVR frequency normalized by intratelomeric reads |
| `TTCGGG_arbitrary_context_norm_by_intratel_reads` | TTCGGG TVR frequency normalized by intratelomeric reads |
| `TTTGGG_arbitrary_context_norm_by_intratel_reads` | TTTGGG TVR frequency normalized by intratelomeric reads |
| `ATAGGG_arbitrary_context_norm_by_intratel_reads` | ATAGGG TVR frequency normalized by intratelomeric reads |
| `CATGGG_arbitrary_context_norm_by_intratel_reads` | CATGGG TVR frequency normalized by intratelomeric reads |
| `CTAGGG_arbitrary_context_norm_by_intratel_reads` | CTAGGG TVR frequency normalized by intratelomeric reads |
| `GTAGGG_arbitrary_context_norm_by_intratel_reads` | GTAGGG TVR frequency normalized by intratelomeric reads |
| `TAAGGG_arbitrary_context_norm_by_intratel_reads` | TAAGGG TVR frequency normalized by intratelomeric reads |
| `TCAGGG_singletons_norm_by_all_reads` | TCAGGG singleton frequency normalized by total reads |
| `TGAGGG_singletons_norm_by_all_reads` | TGAGGG singleton frequency normalized by total reads |
| `TTGGGG_singletons_norm_by_all_reads` | TTGGGG singleton frequency normalized by total reads |
| `TTCGGG_singletons_norm_by_all_reads` | TTCGGG singleton frequency normalized by total reads |
| `TTTGGG_singletons_norm_by_all_reads` | TTTGGG singleton frequency normalized by total reads |
| `ATAGGG_singletons_norm_by_all_reads` | ATAGGG singleton frequency normalized by total reads |
| `CATGGG_singletons_norm_by_all_reads` | CATGGG singleton frequency normalized by total reads |
| `CTAGGG_singletons_norm_by_all_reads` | CTAGGG singleton frequency normalized by total reads |
| `GTAGGG_singletons_norm_by_all_reads` | GTAGGG singleton frequency normalized by total reads |
| `TAAGGG_singletons_norm_by_all_reads` | TAAGGG singleton frequency normalized by total reads |

#### 2. TVR_top_contexts.tsv

Contains the most frequent sequence contexts surrounding telomeric variant repeats (TVRs).

**Fields:**
- Context sequences with flanking regions
- Frequency counts and normalized values
- Statistical measures for context analysis

#### 3. singletons.tsv

Analysis of singleton TVRs (single occurrences of variant repeats within reads).

**Fields:**
- Individual TVR occurrences
- Position information
- Context sequences
- Quality scores

### Single-Cell Specific Outputs

#### sc_summary.tsv
Per-cell telomere content analysis results with the same fields as the main summary.tsv but broken down by cell barcode.

#### barcode_counts.tsv
Read count statistics per cell barcode:
- Barcode ID
- Total reads per barcode  
- Telomeric reads per barcode
- Quality metrics per cell

### Visualization Outputs (plots/)

TelomereHunter2 generates comprehensive visualizations:

1. **GC Distribution Plots** - GC content analysis
2. **Telomere Content Plots** - Content estimates across samples
3. **TVR Analysis Plots** - Variant repeat patterns
4. **Chromosome Distribution Plots** - Telomeric reads per chromosome
5. **Singleton Analysis Plots** - Singleton TVR patterns

**Plot formats available:**
- PDF (default)
- PNG 
- SVG
- All formats with `--plotFileFormat all`

### Log Files

Detailed execution logs for troubleshooting:

- `filtering.log` - Read filtering process
- `analysis.log` - Main analysis steps
- `error.log` - Error messages and warnings

## Output File Usage Examples

### Reading summary.tsv in R:
```r
library(readr)
results <- read_tsv("results/sample_TelomerCnt_ID/summary.tsv")
print(results$tel_content)  # Telomere content estimate
```

### Reading summary.tsv in Python:
```python
import pandas as pd
results = pd.read_csv("results/sample_TelomerCnt_ID/summary.tsv", sep='\t')
print(f"Telomere content: {results['tel_content'].iloc[0]}")
```

## FAQ

**Q: What does the tel_content value represent?**  
A: The GC-corrected telomere content estimate, representing the relative amount of telomeric DNA in the sample.

**Q: Why are some TVR fields showing 0?**  
A: This indicates that specific telomeric variant repeats were not detected in sufficient quantities in your sample.

**Q: How do I interpret TRPM values?**  
A: TRPM (Telomeric Reads Per Million) provides a normalized measure of telomeric read abundance, allowing comparison across samples with different sequencing depths.

**Q: What if my cytoband file is missing?**  
A: Analysis will proceed without subtelomeric region annotation. Use `-b` to specify a cytoband file for complete analysis.

## Further Documentation

- [Installation and Usage](Installation-and-Usage.md) - Setup and basic usage
- [Advanced Options and Customization](Advanced-Options-and-Customization.md) - Advanced configuration
- [Main README](../README.md) - Project overview and quick start

## Links

- [GitHub Repository](https://github.com/ferdinand-popp/telomerehunter2)
- [Docker Hub](https://hub.docker.com/r/fpopp22/telomerehunter2)
- [Original TelomereHunter Paper](https://bmcbioinformatics.biomedcentral.com/articles/10.1186/s12859-019-2851-0)